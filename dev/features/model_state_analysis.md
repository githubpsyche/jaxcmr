I have code that does this in some ways, but I want a streamlined pipeline.